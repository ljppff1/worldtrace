package com.example.fragment;import java.util.ArrayList;import java.util.List;import org.apache.http.NameValuePair;import org.json.JSONArray;import org.json.JSONException;import org.json.JSONObject;import android.app.Activity;import android.app.AlertDialog;import android.content.DialogInterface;import android.content.Intent;import android.content.SharedPreferences;import android.os.Bundle;import android.support.annotation.Nullable;import android.support.v4.app.Fragment;import android.text.TextUtils;import android.view.LayoutInflater;import android.view.View;import android.view.View.OnClickListener;import android.view.ViewGroup;import android.widget.AdapterView;import android.widget.AdapterView.OnItemClickListener;import android.widget.BaseAdapter;import android.widget.ImageView;import android.widget.ListView;import android.widget.ProgressBar;import android.widget.TextView;import com.example.worldtrade.F3Next1Activity;import com.example.worldtrade.KaiTongzhanhuiActivity;import com.example.worldtrade.MainActivityl3;import com.example.worldtrade.R;import com.lidroid.xutils.HttpUtils;import com.lidroid.xutils.exception.HttpException;import com.lidroid.xutils.http.RequestParams;import com.lidroid.xutils.http.ResponseInfo;import com.lidroid.xutils.http.callback.RequestCallBack;import com.lidroid.xutils.http.client.HttpRequest;public class Fragment3 extends Fragment{	private View parentView;	private ListView mLvf11;   private ArrayList<String> mDataList =new ArrayList<String>();   private List<Data1> mlist =new ArrayList<Fragment3.Data1>();private Myadapter adapter;private ProgressBar progressBar_sale;private String CHINESE;private ImageView mIvvv1;private ImageView mIvvv2;private String wechatNo;	@Override	@Nullable	public View onCreateView(LayoutInflater inflater,			@Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {		SharedPreferences mySharedPreferences1= getActivity().getSharedPreferences("USER", Activity.MODE_PRIVATE); 		CHINESE =mySharedPreferences1.getString("CHINESE","1");		wechatNo =mySharedPreferences1.getString("wechatNo","");		if(CHINESE.equals("1")){			parentView = inflater.inflate(R.layout.fragment3, container, false);		}else{			parentView = inflater.inflate(R.layout.fragment3e, container, false);		}		mLvf11 =(ListView)parentView.findViewById(R.id.mLvf11);		progressBar_sale =(ProgressBar)parentView.findViewById(R.id.progressBar_sale);		progressBar_sale.setVisibility(View.GONE);		mIvvv1 =(ImageView)parentView.findViewById(R.id.mIvvv1);		mIvvv2 =(ImageView)parentView.findViewById(R.id.mIvvv2);		mIvvv1.setOnClickListener(listener);		mIvvv2.setOnClickListener(listener);		initDatao1();				mLvf11.setOnItemClickListener(new OnItemClickListener() {			@Override			public void onItemClick(AdapterView<?> parent, View view,					int position, long id) {				Intent intent =new Intent(getActivity(), F3Next1Activity.class);				intent.putExtra("ID", mlist.get(position).oid);			startActivity(intent);				}		});				return parentView;	}		public void choiceWhat(View v){		   new AlertDialog.Builder(getActivity()).setTitle(R.string.zg5)//设置对话框标题  		     .setMessage(R.string.zg6)//设置显示的内容  		     .setPositiveButton(R.string.zg7,new DialogInterface.OnClickListener() {//添加确定按钮  		         @Override  		         public void onClick(DialogInterface dialog, int which) {//确定按钮的响应事件  		        		startActivity(new Intent(getActivity(),MainActivityl3.class));		  		         }  		     }).setNegativeButton(R.string.zg8,new DialogInterface.OnClickListener() {//添加返回按钮  		         @Override  		         public void onClick(DialogInterface dialog, int which) {//响应事件  		  		         }  		     }).show();		  	}		OnClickListener listener =new OnClickListener() {				@Override		public void onClick(View v) {			if(!TextUtils.isEmpty(wechatNo)){				startActivity(new Intent(getActivity(),KaiTongzhanhuiActivity.class));								}else{					//startActivity(new Intent(getActivity(),MainActivityl3.class));					choiceWhat(v);				}		}	};	private void initDatao1() {	downloadsearcho1("0");}public void downloadsearcho1(String area11){	progressBar_sale.setVisibility(View.VISIBLE);	 RequestParams params = new RequestParams();   List<NameValuePair> nameValuePairs=new ArrayList<NameValuePair>(10);      params.addBodyParameter(nameValuePairs);   HttpUtils http = new HttpUtils();   http.send(HttpRequest.HttpMethod.POST,  		 "http://pine.i3.com.hk/trade/json/exhibitionlist.php",           params,           new RequestCallBack<String>() {				private String msg;				@Override				public void onFailure(HttpException arg0, String arg1) {									}				@Override				public void onSuccess(ResponseInfo<String> arg0) {					JSONObject jsonObject;					try {						jsonObject = new JSONObject(arg0.result);						String string_code = jsonObject.getString("code");						 msg = jsonObject.getString("msg");												 int  num_code=Integer.valueOf(string_code);						 if (num_code==1) {							 //保存到本地							 mlist.clear();							 JSONArray array = jsonObject.getJSONArray("data");							 for(int i=0;i<array.length();i++){								 Data1 d1 =new Data1();								 d1.oid=array.getJSONObject(i).getString("id");								 d1.oname=array.getJSONObject(i).getString("name");								 mlist.add(d1);							 }								progressBar_sale.setVisibility(View.GONE);                            initd1a();						 }						 else {									progressBar_sale.setVisibility(View.GONE);						}					} catch (JSONException e) {						progressBar_sale.setVisibility(View.GONE);					}				}				private void initd1a() {						adapter =new Myadapter();					mLvf11.setAdapter(adapter);}        });}class Data1 {	public String oid;	public String oname;}	class Holder{		TextView mTvri10,mTvri11,mTvri12,mEE1;		ImageView imageView;	}	class  Myadapter extends   BaseAdapter{		@Override		public View getView(int position, View convertView, ViewGroup parent) {			        						Holder holder = null;			if(convertView==null){				convertView = LayoutInflater.from(getActivity())						.inflate(R.layout.item_listview_3, null);				holder = new Holder();				holder.mTvri10 =(TextView)convertView.findViewById(R.id.mRl112);				holder.mEE1 =(TextView)convertView.findViewById(R.id.mEE1);								holder.imageView =(ImageView)convertView.findViewById(R.id.iv_listview_rent_pic);				convertView.setTag(holder);			}else{				holder =(Holder)convertView.getTag();			}									if(CHINESE.equals("1")){				holder.mEE1.setText(R.string.ac11);			}else{				holder.mEE1.setText(R.string.ac11e);			}			holder.mTvri10.setText(mlist.get(position).oname);			return convertView;		}		@Override		public int getCount() {			// TODO Auto-generated method stub			return mlist.size();		}		@Override		public Object getItem(int position) {			// TODO Auto-generated method stub			return null;		}		@Override		public long getItemId(int position) {			// TODO Auto-generated method stub			return 0;		}	}		}