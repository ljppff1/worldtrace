package com.example.fragment;import com.example.worldtrade.ChanPinLieBiaoActivity;import com.example.worldtrade.GongsijianjieActivity;import com.example.worldtrade.KaiTonghuiyuanActivity;import com.example.worldtrade.PingJiaActivity;import com.example.worldtrade.R;import com.example.worldtrade.XiaoxizhongxinActivity;import android.content.Intent;import android.os.Bundle;import android.support.annotation.Nullable;import android.support.v4.app.Fragment;import android.view.KeyEvent;import android.view.LayoutInflater;import android.view.MotionEvent;import android.view.View;import android.view.ViewGroup;import android.view.View.OnClickListener;import android.view.View.OnKeyListener;import android.view.View.OnTouchListener;import android.view.ViewGroup.LayoutParams;import android.widget.ImageView;import android.widget.LinearLayout;import android.widget.PopupWindow;import android.widget.RelativeLayout;public class Fragment4 extends Fragment{	private View parentView;	private RelativeLayout mRlf4a1;	private RelativeLayout mRlf42;	private LinearLayout mLLf41;	private RelativeLayout mRlf43;	private RelativeLayout mRlf421;	private ImageView mIvright1;	private RelativeLayout mRlf4211;		@Override	@Nullable	public View onCreateView(LayoutInflater inflater,			@Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {		parentView = inflater.inflate(R.layout.fragment4, container, false);		mIvright1 =(ImageView)parentView.findViewById(R.id.mIvright1);		mIvright1.setOnClickListener(listener);		mRlf4211 =(RelativeLayout)parentView.findViewById(R.id.mRlf4211);		mRlf4211.setOnClickListener(listener);		mRlf43 =(RelativeLayout)parentView.findViewById(R.id.mRlf43);		mRlf43.setOnClickListener(listener);		mRlf4a1 =(RelativeLayout)parentView.findViewById(R.id.mRlf4a1);		mRlf4a1.setOnClickListener(listener);		mRlf42 =(RelativeLayout)parentView.findViewById(R.id.mRlf42);		mRlf42.setOnClickListener(listener);		mRlf421 =(RelativeLayout)parentView.findViewById(R.id.mRlf421);		mRlf421.setOnClickListener(listener);		mLLf41 =(LinearLayout)parentView.findViewById(R.id.mLLf41);		mLLf41.setOnClickListener(listener);				return parentView;	}	OnClickListener listener =new OnClickListener() {				@Override		public void onClick(View v) {			switch (v.getId()) {			case R.id.mRlf4a1:				startActivity(new Intent(getActivity(), KaiTonghuiyuanActivity.class));				break;			case R.id.mLLf41:				startActivity(new Intent(getActivity(), GongsijianjieActivity.class));				break;			case R.id.mRlf42:				startActivity(new Intent(getActivity(), PingJiaActivity.class));				break;			case R.id.mRlf43:				startActivity(new Intent(getActivity(), XiaoxizhongxinActivity.class));				break;			case R.id.mRlf421:				startActivity(new Intent(getActivity(), ChanPinLieBiaoActivity.class));				break;			case R.id.mIvright1:				showWindow();				break;			case R.id.mRlf4211:				startActivity(new Intent(getActivity(), com.example.worldtrade.ChanPinFabuActivity.class));				break;			default:				break;			}		}	};	private View layout;		private PopupWindow mPop;	private void showWindow() {						LayoutInflater mLayoutInflater = (LayoutInflater) getActivity().getSystemService(getActivity().LAYOUT_INFLATER_SERVICE);		 layout = mLayoutInflater.inflate(R.layout.window1, null);			layout.setFocusable(true); // 这个很重要  			layout.setFocusableInTouchMode(true);  		 mPop = new PopupWindow(layout,320, LayoutParams.WRAP_CONTENT);		 mPop.setFocusable(true);		 mPop.setOutsideTouchable(true);		 mPop.update();			//位置在R.id.button的正下方		 mPop.showAsDropDown(parentView.findViewById(R.id.mIvright1), 54,14);		// mPop.showAtLocation(this.findViewById(R.id.mLLf3n), Gravity.RIGHT|Gravity.TOP,30, 60);		//popwindow的宽度和按钮的宽度相同都是230		layout.setOnKeyListener(new OnKeyListener() {			@Override			public boolean onKey(View v, int keyCode, KeyEvent event) {				switch (keyCode) {				case KeyEvent.KEYCODE_BACK:					if (mPop != null && mPop.isShowing()) {						mPop.dismiss();						mPop = null;						return true;					}					break;				default:					break;				}				return false;			}		});		layout.setOnTouchListener(new OnTouchListener() {			@Override			public boolean onTouch(View v, MotionEvent event) {				 if (mPop != null && mPop.isShowing()) {					 mPop.dismiss();				  mPop = null; }				 return true;			}		});					}	}