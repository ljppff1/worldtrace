package com.example.fragment;import java.util.ArrayList;import java.util.List;import org.apache.http.NameValuePair;import org.apache.http.message.BasicNameValuePair;import org.json.JSONArray;import org.json.JSONException;import org.json.JSONObject;import com.example.worldtrade.R;import com.lidroid.xutils.HttpUtils;import com.lidroid.xutils.exception.HttpException;import com.lidroid.xutils.http.RequestParams;import com.lidroid.xutils.http.ResponseInfo;import com.lidroid.xutils.http.callback.RequestCallBack;import com.lidroid.xutils.http.client.HttpRequest;import com.nostra13.universalimageloader.core.DisplayImageOptions;import com.nostra13.universalimageloader.core.ImageLoader;import com.nostra13.universalimageloader.core.display.FadeInBitmapDisplayer;import android.app.AlertDialog;import android.app.AlertDialog.Builder;import android.content.DialogInterface;import android.graphics.Bitmap;import android.graphics.Color;import android.os.Bundle;import android.support.annotation.Nullable;import android.support.v4.app.Fragment;import android.text.SpannableString;import android.text.Spanned;import android.text.TextPaint;import android.text.TextUtils;import android.text.method.LinkMovementMethod;import android.text.style.ClickableSpan;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.view.View.OnClickListener;import android.widget.AdapterView;import android.widget.BaseAdapter;import android.widget.Button;import android.widget.EditText;import android.widget.ImageView;import android.widget.ListView;import android.widget.ProgressBar;import android.widget.TextView;import android.widget.Toast;import android.widget.AdapterView.OnItemClickListener;public class FragmentRegister extends Fragment  {private TextView mTvreg2;private TextView mTvreg1;private EditText mEtfr1;private EditText mEtfr3;private EditText mEtfr4;private Button ui_login_btn;private ProgressBar progressBar_sale;private TextView mTvr21;@Override@Nullablepublic View onCreateView(LayoutInflater inflater,		@Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {		View view =inflater.inflate(R.layout.fragmentregister, container, false);		progressBar_sale =(ProgressBar)view.findViewById(R.id.progressBar_sale);		progressBar_sale.setVisibility(View.GONE);		mTvreg2 = (TextView)view.findViewById(R.id.mTvreg2);		mTvreg2.setOnClickListener(listener);		mTvreg1 = (TextView)view.findViewById(R.id.mTvreg1);		mTvreg1.setOnClickListener(listener);		mEtfr1=(EditText)view.findViewById(R.id.mEtfr1);		mEtfr3=(EditText)view.findViewById(R.id.mEtfr3);		mEtfr4=(EditText)view.findViewById(R.id.mEtfr4);		ui_login_btn =(Button)view.findViewById(R.id.ui_login_btn);		ui_login_btn.setOnClickListener(listener);		mTvr21 =(TextView)view.findViewById(R.id.mTvr21);        String url_0_text = "[私嘞蘼明";        String url_1_text = "使用l款t";        String url_2_text = "按以上登I即代表意接受  World Trade  之   ";        String url_3_text = "  及  ";        String url_4_text = "  所s束";                mTvr21.setText("按以上[登]I即代表意接受 World Trade 之  ");        SpannableString spStr = new SpannableString(url_0_text);        spStr.setSpan(new ClickableSpan() {            @Override            public void updateDrawState(TextPaint ds) {                super.updateDrawState(ds);                ds.setColor(Color.WHITE);       //设置文件颜色                ds.setUnderlineText(true);      //设置下划线            }            @Override            public void onClick(View widget) {            }        }, 0, url_0_text.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);       // mTvr21.setHighlightColor(Color.TRANSPARENT); //设置点击后的颜色为透明，否则会一直出现高亮        mTvr21.append(spStr);        mTvr21.append(url_3_text);        SpannableString spStr1 = new SpannableString(url_1_text);        spStr1.setSpan(new ClickableSpan() {            @Override            public void updateDrawState(TextPaint ds) {                super.updateDrawState(ds);                ds.setColor(Color.WHITE);       //设置文件颜色                ds.setUnderlineText(true);      //设置下划线            }            @Override            public void onClick(View widget) {            }        }, 0, url_1_text.length(), Spanned.SPAN_EXCLUSIVE_EXCLUSIVE);       // mTvr21.setHighlightColor(Color.TRANSPARENT); //设置点击后的颜色为透明，否则会一直出现高亮        mTvr21.append(spStr1);        mTvr21.append(url_4_text);                        mTvr21.setMovementMethod(LinkMovementMethod.getInstance());//开始响应点击事件	return view;}OnClickListener listener =new OnClickListener() {		@Override	public void onClick(View v) {		switch (v.getId()) {		case R.id.mTvreg2:			showDialog();			break;		case R.id.mTvreg1:			showDialog1();			break;		case R.id.ui_login_btn:			if(TextUtils.isEmpty(mEtfr1.getEditableText().toString())){				Toast.makeText(getActivity(), getResources().getString(R.string.abc41), 0).show();			}else if(TextUtils.isEmpty(mEtfr3.getEditableText().toString())){				Toast.makeText(getActivity(), getResources().getString(R.string.abc42), 0).show();			}else if(TextUtils.isEmpty(mEtfr4.getEditableText().toString())){				Toast.makeText(getActivity(), getResources().getString(R.string.abc43), 0).show();			}			else{				initData();			}			break;		default:			break;		}	}};private void initData() {	downloadsearch("0");}public void downloadsearch(String area11){	progressBar_sale.setVisibility(View.VISIBLE);	 RequestParams params = new RequestParams();   List<NameValuePair> nameValuePairs=new ArrayList<NameValuePair>(10);   nameValuePairs.add(new BasicNameValuePair("UserEmail", mEtfr1.getEditableText().toString()));   nameValuePairs.add(new BasicNameValuePair("LoginName", mEtfr3.getEditableText().toString()));   nameValuePairs.add(new BasicNameValuePair("LoginPwd", mEtfr4.getEditableText().toString()));   nameValuePairs.add(new BasicNameValuePair("UserBirtyYear", mTvreg2.getText().toString()));      params.addBodyParameter(nameValuePairs);   HttpUtils http = new HttpUtils();   http.send(HttpRequest.HttpMethod.POST,  		 "http://josie.i3.com.hk/FG/json/m_reg.php",           params,           new RequestCallBack<String>() {				@Override				public void onFailure(HttpException arg0, String arg1) {					// TODO Auto-generated method stub									}				@Override				public void onSuccess(ResponseInfo<String> arg0) {					JSONObject jsonObject;					try {						jsonObject = new JSONObject(arg0.result);						String string_code = jsonObject.getString("code");						String msg = jsonObject.getString("msg");												 int  num_code=Integer.valueOf(string_code);						 if (num_code==1) {							 //保存到本地							 JSONObject array = jsonObject.getJSONObject("data");							 Toast.makeText(getActivity(),  getResources().getString(R.string.abc44), 0).show();								progressBar_sale.setVisibility(View.GONE);						 /**						  * {"code":"1","msg":"Reg success","data":{"UserID":3,"LoginName":"\u5728","UserEmail":"ljppff@163.com"","UserName":null,"UserGender":1,"UserBirtyYear":null}}						  */						 }												 else {								 Toast.makeText(getActivity(),msg, 0).show();									progressBar_sale.setVisibility(View.GONE);							//new AlertInfoDialog(SaleActivity.this).show();						}					} catch (JSONException e) {						//new Dialog_noInternet(SaleActivity.this).show();						progressBar_sale.setVisibility(View.GONE);							 Toast.makeText(getActivity(),  getResources().getString(R.string.abc44), 0).show();						e.printStackTrace();					}																			}        });}private ArrayList<Integer> aa1; private void showDialog() {    Builder builder=new Builder(getActivity());    //设置对话框的图标    builder.setIcon(R.drawable.ic_launcher);    //设置对话框的标题    builder.setTitle("x癯錾年份");    //0: 默认第一个单选按钮被选中    final String[] arr1 =new String[116];    for(int i=0;i<=115;i++){    	arr1[i]=(i+1900)+"";    }    builder.setSingleChoiceItems(arr1, 0, new DialogInterface.OnClickListener(){        public void onClick(DialogInterface dialog, int which) {            String hoddy=arr1[which];            mTvreg2.setText(""+hoddy);        }    });        //添加一个确定按钮    builder.setPositiveButton(" _ 定 ", new DialogInterface.OnClickListener(){        public void onClick(DialogInterface dialog, int which) {                    }    });    //创建一个单选按钮对话框    AlertDialog dialog = builder.create();    dialog.show();}private void showDialog1() {    Builder builder=new Builder(getActivity());    //设置对话框的图标    builder.setIcon(R.drawable.ic_launcher);    //设置对话框的标题    builder.setTitle("x穹Q^");    //0: 默认第一个单选按钮被选中    builder.setSingleChoiceItems(R.array.people, 0, new DialogInterface.OnClickListener(){        public void onClick(DialogInterface dialog, int which) {            String hoddy=getResources().getStringArray(R.array.people)[which];            mTvreg1.setText(""+hoddy);        }    });        //添加一个确定按钮    builder.setPositiveButton(" _ 定 ", new DialogInterface.OnClickListener(){        public void onClick(DialogInterface dialog, int which) {                    }    });    //创建一个单选按钮对话框    AlertDialog dialog = builder.create();    dialog.show();}   }