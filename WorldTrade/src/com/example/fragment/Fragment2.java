package com.example.fragment;import java.util.ArrayList;import java.util.List;import org.apache.http.NameValuePair;import org.json.JSONArray;import org.json.JSONException;import org.json.JSONObject;import com.example.fragment.FragmentRegister.Data1;import com.example.worldtrade.ItemlistActivity;import com.example.worldtrade.MainActivity1;import com.example.worldtrade.MainActivity3;import com.example.worldtrade.MainActivityl2;import com.example.worldtrade.R;import com.lidroid.xutils.HttpUtils;import com.lidroid.xutils.exception.HttpException;import com.lidroid.xutils.http.RequestParams;import com.lidroid.xutils.http.ResponseInfo;import com.lidroid.xutils.http.callback.RequestCallBack;import com.lidroid.xutils.http.client.HttpRequest;import android.annotation.SuppressLint;import android.app.Activity;import android.app.AlertDialog;import android.app.Dialog;import android.content.DialogInterface;import android.content.Intent;import android.content.SharedPreferences;import android.os.Bundle;import android.support.annotation.Nullable;import android.support.v4.app.Fragment;import android.text.TextUtils;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.widget.AdapterView;import android.widget.BaseAdapter;import android.widget.GridView;import android.widget.ImageView;import android.widget.ProgressBar;import android.widget.TextView;import android.widget.Toast;import android.widget.AdapterView.OnItemClickListener;public class Fragment2 extends Fragment{	private View parentView;	private GridView mGvm1;    private int[] a ={R.string.b11,R.string.b1,R.string.b2,R.string.b3,R.string.b4,R.string.b5,R.string.b6,R.string.b7,R.string.b8,R.string.b9,R.string.b10};	private Myadapter adapter;	private List<Data1> listd1 =new ArrayList<Fragment2.Data1>();	private String[] listd1s =new String[]{};	private int ilistd1=-1;	private ProgressBar progressBar_sale;	private String CHINESE;	@Override	@Nullable	public View onCreateView(LayoutInflater inflater,			@Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {		SharedPreferences mySharedPreferences1= getActivity().getSharedPreferences("USER", Activity.MODE_PRIVATE); 		CHINESE =mySharedPreferences1.getString("CHINESE","1");		if(CHINESE.equals("1")){			parentView = inflater.inflate(R.layout.fragment2, container, false);		}else{			parentView = inflater.inflate(R.layout.fragment2e, container, false);		}		mGvm1 =(GridView)parentView.findViewById(R.id.mGvm1);		progressBar_sale =(ProgressBar)parentView.findViewById(R.id.progressBar_sale);		progressBar_sale.setVisibility(View.GONE);		mGvm1.setOnItemClickListener(new OnItemClickListener() {			@Override			public void onItemClick(AdapterView<?> parent, View view,					int position, long id) {				SharedPreferences mySharedPreferences= getActivity().getSharedPreferences("USER", Activity.MODE_PRIVATE); 				if(!TextUtils.isEmpty(mySharedPreferences.getString("wechatNo",""))){                if(mySharedPreferences.getString("wechatNo","").equals("1")){                	Intent intent =new Intent(getActivity(), MainActivity1.class);                	intent.putExtra("OID", listd1.get(position).oid);				startActivity(intent);                }else{                	Intent intent =new Intent(getActivity(), MainActivity3.class);                	intent.putExtra("OID", listd1.get(position).oid);				startActivity(intent);                }}else{                	Intent intent =new Intent(getActivity(), MainActivityl2.class);                	intent.putExtra("OID", listd1.get(position).oid);				    startActivity(intent);                }			}		});						initDatao1();				return parentView;	}private void initDatao1() {	downloadsearcho1("0");}public void downloadsearcho1(String area11){	progressBar_sale.setVisibility(View.VISIBLE);	 RequestParams params = new RequestParams();   List<NameValuePair> nameValuePairs=new ArrayList<NameValuePair>(10);      params.addBodyParameter(nameValuePairs);   HttpUtils http = new HttpUtils();   http.send(HttpRequest.HttpMethod.POST,  		 "http://pine.i3.com.hk/trade/json/categoryonelist.php",           params,           new RequestCallBack<String>() {				private String msg;				@Override				public void onFailure(HttpException arg0, String arg1) {					// TODO Auto-generated method stub									}				@Override				public void onSuccess(ResponseInfo<String> arg0) {					JSONObject jsonObject;					try {						jsonObject = new JSONObject(arg0.result);						String string_code = jsonObject.getString("code");						 msg = jsonObject.getString("msg");												 int  num_code=Integer.valueOf(string_code);						 if (num_code==1) {							 //保存到本地							 listd1.clear();														 JSONArray array = jsonObject.getJSONArray("data");							 listd1s=new String[array.length()];							 for(int i=0;i<array.length();i++){																 Data1 d1 =new Data1();								 d1.oid=array.getJSONObject(i).getString("oid");								 d1.oname=array.getJSONObject(i).getString("oname");								 d1.english=array.getJSONObject(i).getString("english");								 								 listd1.add(d1);								 listd1s[i]=d1.oname;							 }								progressBar_sale.setVisibility(View.GONE);                            initd1a();						 }												 else {								 Toast.makeText(getActivity(),msg, 0).show();									progressBar_sale.setVisibility(View.GONE);							//new AlertInfoDialog(SaleActivity.this).show();						}					} catch (JSONException e) {						//new Dialog_noInternet(SaleActivity.this).show();						progressBar_sale.setVisibility(View.GONE);						e.printStackTrace();					}																			}				private void initd1a() {						adapter= new Myadapter();				mGvm1.setAdapter(adapter);}        });}class Data1 {	public String oid;	public String oname;	public String english;}	class Holder{		TextView mTvri12;		ImageView imageView;	}	class  Myadapter extends   BaseAdapter{		@SuppressLint("NewApi")		@Override		public View getView(int position, View convertView, ViewGroup parent) {			        						Holder holder = null;			if(convertView==null){				convertView = LayoutInflater.from(getActivity())						.inflate(R.layout.item_gridview_1, null);				holder = new Holder();				holder.mTvri12 =(TextView)convertView.findViewById(R.id.mTvg1);				convertView.setTag(holder);				}else{				holder =(Holder)convertView.getTag();			}			if(CHINESE.equals("1")){			holder.mTvri12.setText(listd1.get(position).oname);			}else{				holder.mTvri12.setText(listd1.get(position).english);			}			return convertView;		}		@Override		public int getCount() {			// TODO Auto-generated method stub			return listd1.size();		}		@Override		public Object getItem(int position) {			// TODO Auto-generated method stub			return null;		}		@Override		public long getItemId(int position) {			// TODO Auto-generated method stub			return 0;		}	}	}