package com.example.fragment;import java.util.ArrayList;import java.util.List;import org.apache.http.NameValuePair;import org.apache.http.message.BasicNameValuePair;import org.json.JSONArray;import org.json.JSONException;import org.json.JSONObject;import com.example.worldtrade.MainActivity;import com.example.worldtrade.MainActivity2;import com.example.worldtrade.R;import com.lidroid.xutils.HttpUtils;import com.lidroid.xutils.exception.HttpException;import com.lidroid.xutils.http.RequestParams;import com.lidroid.xutils.http.ResponseInfo;import com.lidroid.xutils.http.callback.RequestCallBack;import com.lidroid.xutils.http.client.HttpRequest;import com.nostra13.universalimageloader.core.DisplayImageOptions;import com.nostra13.universalimageloader.core.ImageLoader;import com.nostra13.universalimageloader.core.display.FadeInBitmapDisplayer;import android.app.Activity;import android.content.Intent;import android.content.SharedPreferences;import android.graphics.Bitmap;import android.os.Bundle;import android.support.annotation.Nullable;import android.support.v4.app.Fragment;import android.text.TextUtils;import android.view.LayoutInflater;import android.view.View;import android.view.ViewGroup;import android.view.View.OnClickListener;import android.widget.AdapterView;import android.widget.BaseAdapter;import android.widget.EditText;import android.widget.ImageView;import android.widget.ListView;import android.widget.ProgressBar;import android.widget.TextView;import android.widget.Toast;import android.widget.AdapterView.OnItemClickListener;public class FragmentLogin extends Fragment  {private EditText ui_username_input;private EditText ui_password_input;private View ui_login_btn;private ProgressBar progressBar_sale;private View parentView;private String CHINESE;@Override@Nullablepublic View onCreateView(LayoutInflater inflater,		@Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {		SharedPreferences mySharedPreferences1= getActivity().getSharedPreferences("USER", Activity.MODE_PRIVATE); 		CHINESE =mySharedPreferences1.getString("CHINESE","1");		if(CHINESE.equals("1")){			parentView = inflater.inflate(R.layout.fragmentlogin, container, false);		}else{			parentView = inflater.inflate(R.layout.fragmentlogine, container, false);		}		ui_username_input= (EditText)parentView.findViewById(R.id.ui_username_input);		ui_password_input=  (EditText)parentView.findViewById(R.id.ui_password_input);		ui_login_btn =parentView.findViewById(R.id.ui_login_btn);		progressBar_sale =(ProgressBar)parentView.findViewById(R.id.progressBar_sale);		progressBar_sale.setVisibility(View.GONE);		ui_login_btn.setOnClickListener(listener);	  return parentView;}  @Overridepublic void onResume() {				super.onResume();}OnClickListener listener =new OnClickListener() {		@Override	public void onClick(View v) {		switch (v.getId()) {		case R.id.ui_login_btn:			if(TextUtils.isEmpty(ui_username_input.getEditableText().toString())){				Toast.makeText(getActivity(), getResources().getString(R.string.abc34), 0).show();			}else if(TextUtils.isEmpty(ui_password_input.getEditableText().toString())){				Toast.makeText(getActivity(), getResources().getString(R.string.abc35), 0).show();			}else{				initData();			}			break;		default:			break;		}	}};private void initData() {	downloadsearch("0");}public void downloadsearch(String area11){	progressBar_sale.setVisibility(View.VISIBLE);	 RequestParams params = new RequestParams();   List<NameValuePair> nameValuePairs=new ArrayList<NameValuePair>(10);   nameValuePairs.add(new BasicNameValuePair("number", ui_username_input.getEditableText().toString()));   nameValuePairs.add(new BasicNameValuePair("password", ui_password_input.getEditableText().toString()));      params.addBodyParameter(nameValuePairs);   HttpUtils http = new HttpUtils();   http.send(HttpRequest.HttpMethod.POST,  		 "http://pine.i3.com.hk/trade/json/login.php",           params,           new RequestCallBack<String>() {				private String msg;				@Override				public void onFailure(HttpException arg0, String arg1) {					// TODO Auto-generated method stub									}				@Override				public void onSuccess(ResponseInfo<String> arg0) {					JSONObject jsonObject;					try {						jsonObject = new JSONObject(arg0.result);						String string_code = jsonObject.getString("code");						 msg = jsonObject.getString("msg");						 JSONObject data =jsonObject.getJSONObject("data");						 						 String number = data.getString("number");						 String name = data.getString("name");						 String username = data.getString("username");						 String wechatNo = data.getString("wechatNo");						 String id = data.getString("id");												 						 							SharedPreferences mySharedPreferences= getActivity().getSharedPreferences("USER", Activity.MODE_PRIVATE); 							SharedPreferences.Editor editor = mySharedPreferences.edit(); 							editor.putString("number", number); 							editor.putString("name",name); 							editor.putString("username",username); 							editor.putString("wechatNo",wechatNo); 							editor.putString("id",id); 							editor.commit(); 														if(wechatNo.equals("1")){								startActivity(new Intent(getActivity(),MainActivity.class));							}else{								startActivity(new Intent(getActivity(),MainActivity2.class));							}							getActivity().finish();						 int  num_code=Integer.valueOf(string_code);						 if (num_code==1) {							 //保存到本地							 JSONObject array = jsonObject.getJSONObject("data");								progressBar_sale.setVisibility(View.GONE);						 /**						  * {"code":"1","msg":"Login success","data":{"UserID":"2","LoginName":"ljppff","UserEmail":"ljppff@163.com","UserName":"","UserGender":"1","UserBirtyYear":""}}						  */						 }												 else {								 Toast.makeText(getActivity(),msg, 0).show();									progressBar_sale.setVisibility(View.GONE);							//new AlertInfoDialog(SaleActivity.this).show();						}					} catch (JSONException e) {						progressBar_sale.setVisibility(View.GONE);						e.printStackTrace();					}																			}			        });}   }